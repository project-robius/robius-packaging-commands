# robius-packaging-commands
A multi-platform companion tool to help package your Rust app when using `cargo-packager`.


This program should be invoked by cargo-packager's "before-package" and "before-each-package" hooks,
which you must specify in your `Cargo.toml` file under the `[package.metadata.packager]` section.

See this example of how [the Robrix app uses this crate](https://github.com/project-robius/robrix/blob/980aa7ec48119cda5c08e889d872febefc253c93/Cargo.toml#L127-L163).

This program must be run from the root of the project directory,
which is also where the `cargo-packager` command must be invoked from,
so that shouldn't present any problems.

This program runs in two modes, one for each kind of before-packaging step in cargo-packager.
It requires passing in three arguments:
1. An operating mode, either `before-packaging` or `before-each-packager`.
    * Passing in `before-packaging` specifies that the `before-packaging-command` is being run by cargo-packager, which gets executed only *once* before cargo-packager generates any package bundles.
    * Passing in `before-each-package` specifies that the `before-each-package-command` is being run by cargo-packager, which gets executed multiple times: once for *each* package that cargo-packager is going to generate.
        * The environment variable `CARGO_PACKAGER_FORMAT` is set by cargo-packager to the declare which package format is about to be generated, which include the values given here: <https://docs.rs/cargo-packager/latest/cargo_packager/enum.PackageFormat.html>.
            * `app`, `dmg`: for macOS.
            * `deb`, `appimage`, `pacman`: for Linux.
            * `nsis`: for Windows; `nsis` generates an installer `setup.exe`.
            * `wix`: (UNSUPPORTED) for Windows; generates an `.msi` installer package.
2. The `--binary-name` argument, which specifies the name of the main binary that cargo-packager is going to package. This is the name of the binary that is generated by your app's main crate.
3. The `--path-to-binary` argument, which specifies the path to the main binary that cargo-packager is going to package. This is the path to the binary that is generated by cargo when compiling your app's main crate.

This program uses the `CARGO_PACKAGER_FORMAT` environment variable to determine
which specific build commands and configuration options should be used.
